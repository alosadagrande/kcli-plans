parameters:
 prefix: karim-
 numcpus: 4
 memory: 1024
 disk_size: 30
 masters: 1
 template: rhcos-410.8.20190513.0-qemu.qcow2
 haproxy_template: CentOS-7-x86_64-GenericCloud.qcow2
 allips: []
 allmacs: []
 network: default

{% for node in range(0, masters) %}
{{ prefix }}-master-{{ node }}:
 template: {{ template }}
 numcpus: {{ numcpus }}
 memory: {{ memory }}
 nets:
  - name: {{ network }}
{% if allips and allmacs %}
    ip: {{ allips[node] }}
    mac: {{ allmacs[node] }}
{% else %}
 reservedns: true
{% endif %}
 disks:
  - size: {{ disk_size }}
{% endfor %}

{{ prefix }}-bootstrap:
 template: {{ template }}
 numcpus: 2
 memory: 1024
 nets:
  - name: {{ network }}
{% if allips and allmacs %}
    ip: {{ allips[-1] }}
    mac: {{ allmacs[-1] }}
{% else %}
 reservedns: true
{% endif %}
 disks:
  - size: {{ disk_size }}

{{ prefix }}-haproxy:
 template: {{ haproxy_template }}
 numcpus: 2
 memory: 1024
 nets:
  - name: {{ network }}
 disks:
  - size: 10
